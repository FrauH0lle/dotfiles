# Modules
depends_on = [
  "base",
  "shell/bash",
  "editors/emacs",
  "dev/R",
]

# Host specific dotfiles
[files."$HOME/*"]
source = "home/*"
phase = "config"
type = "link"

# Files to generate
[generate."$HOME/.env.sh"]
prepend = """
#!/bin/sh
# This file was auto-generated by dotdeploy.
# It is NOT safe to edit this file. Changes will be overwritten!

# Prepend directory to PATH if directory exists
# Arguments:
#   $1 - Directory
#   $2 - if 'after' is set, append to PATH
# Env:
#   $PATH
# Outputs:
#   None. Prepends or appands to $PATH if $2 is 'after'
pathmunge() {
    case ":${PATH}:" in
        *:"$1":*)
            ;;
        *)
            if [ "$2" = "after" ] ; then
                PATH=$PATH:$1
            else
                PATH=$1:$PATH
            fi
    esac
}
"""
source = "env.sh"
append = "unset -f pathmunge"

[generate."$HOME/.fzf.sh"]
source = "fzf.sh"
prepend = """
# This file was auto-generated by dotdeploy.
# It is NOT safe to edit this file. Changes will be overwritten!
"""

[generate."$HOME/.aliases.sh"]
source = "aliases.sh"
prepend = """
# This file was auto-generated by dotdeploy.
# It is NOT safe to edit this file. Changes will be overwritten!
"""

[generate."$HOME/.completions.sh"]
source = "completions.sh"
prepend = """
# This file was auto-generated by dotdeploy.
# It is NOT safe to edit this file. Changes will be overwritten!
"""

# Context variables for template expansion
[context_vars]
ncpu = "8"
