# Packages
[[packages]]
install = [ "dotdeploy/base" ]
if = "(eq DOD_DISTRIBUTION_NAME 'gentoo')"

# Files
[[files]]
# Package configuration
source = "gentoo/portage/*"
target = "/etc/portage/*"
phase = "setup"
type = "copy"
if = "(eq DOD_DISTRIBUTION_NAME 'gentoo')"

# Local repository for Gentoo
[[files]]
source = "$DOD_DOTFILES_ROOT/packages/gentoo/overlay/*"
target = "/var/db/repos/local/*"
phase = "setup"
type = "copy"
if = "(eq DOD_DISTRIBUTION_NAME 'gentoo')"

[[files]]
source = "$DOD_DOTFILES_ROOT/packages/gentoo/localrepo.conf"
target = "/etc/portage/repos.conf/localrepo.conf"
phase = "setup"
type = "copy"
if = "(eq DOD_DISTRIBUTION_NAME 'gentoo')"

[[files]]
source = "$DOD_DOTFILES_ROOT/packages/gentoo/localrepo.keywords"
target = "/etc/portage/package.accept_keywords/localrepo"
phase = "setup"
type = "copy"
if = "(eq DOD_DISTRIBUTION_NAME 'gentoo')"

# Tasks
# Necessary base setup, needs to run early
[[tasks]]
exec = "$DOD_DOTFILES_ROOT/scripts/gentoo_base_setup.sh"
phase = "setup"
hook = "pre"
if = "(eq DOD_DISTRIBUTION_NAME 'gentoo')"

[[tasks]]
exec = "$DOD_DOTFILES_ROOT/scripts/prepare_system.sh"
phase = "setup"
hook = "pre"
if = "(eq DOD_DISTRIBUTION_NAME 'ubuntu')"
