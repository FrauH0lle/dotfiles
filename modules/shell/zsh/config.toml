depends_on = [ "shell/common" ]

# Packages
[[packages]]
install = [ "dotdeploy/shell-zsh" ]
if = "(eq DOD_DISTRIBUTION_NAME 'gentoo')"

# Files
# Package configuration
[[files]]
source = "gentoo/portage/*"
target = "/etc/portage/*"
phase = "setup"
type = "copy"
if = "(eq DOD_DISTRIBUTION_NAME 'gentoo')"

[[files]]
source = "common/home/*"
target = "$HOME/*"

[[tasks]]
description = "ZSH setup and maintenance"
[[tasks.config]]
# Ensure .zshenv symlink exists
shell = """ln -svf "$HOME"/.zshenv "$HOME"/.config/zsh/.zshenv"""
[[tasks.update]]
# Update zgenom and plugins
shell = """
zgenom selfupdate
zgenom update
zgenom reset
"""
phase = "update"
[[tasks.remove]]
shell = """
rm -f "$HOME"/.zshenv
rm -rf ${XDG_CONFIG_HOME:-~/.config}/zsh/
rm -rf ${XDG_DATA_HOME:-~/.local/share}/zgenom
"""
